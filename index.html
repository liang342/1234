<!DOCTYPE html>
<html>
<head>
    <title>æ–°æ‰‹èš‚èšæŒ‡å—</title>
    <style>
        /* æ–°å¢ç®¡ç†å‘˜ä¸“å±æ ·å¼ */
        .admin-only { display: none; }
        .admin-mode .admin-only { display: block; }
        .article-controls { margin-top: 10px; }
        #articleForm { border: 1px solid #eee; padding: 15px; }
    </style>
</head>
<body>
    <!-- æ–°å¢æ–‡ç« å‘å¸ƒè¡¨å• -->
    <div id="articleForm" class="admin-only">
        <h3>å‘å¸ƒæ–°æŒ‡å—</h3>
        <input type="text" id="articleTitle" placeholder="æ–‡ç« æ ‡é¢˜">
        <textarea id="articleContent" placeholder="å†…å®¹ï¼ˆæ”¯æŒHTMLï¼‰" rows="5"></textarea>
        <button onclick="publishArticle()">å‘å¸ƒ</button>
    </div>

    <!-- ä¿®æ”¹åçš„æ–‡ç« åˆ—è¡¨ -->
    <div id="main" style="display:none;">
        <h2>çŸ¥è¯†åº“ 
            <button class="admin-only" onclick="toggleEditor()">ğŸ“ å†™æŒ‡å—</button>
        </h2>
        <ul id="articles"></ul>
    </div>

    <script>
        // åˆå§‹åŒ–æ–‡ç« æ•°æ®å­˜å‚¨
        let articles = JSON.parse(localStorage.getItem('articles')) || [
            { 
                id: 1, 
                title: "å…¥é—¨æŒ‡å—", 
                content: "<h4>æ–°äººå¿…è¯»</h4><p>1. æ¯æ—¥ç­¾åˆ°...</p>",
                author: "ç³»ç»Ÿç®¡ç†å‘˜",
                timestamp: "2024-03-20"
            }
        ];

        // å¢å¼ºç™»å½•åŠŸèƒ½
        function login() {
            const userId = document.getElementById("userList").value;
            if (userId && users[userId]) {
                const user = users[userId];
                localStorage.setItem("currentUser", JSON.stringify(user));
                
                // ç®¡ç†å‘˜æ¨¡å¼æ¿€æ´»
                if(user.role === 'admin') {
                    document.body.classList.add('admin-mode');
                }
                
                loadArticles();
            }
        }

        // åŠ¨æ€åŠ è½½æ–‡ç« 
        function loadArticles() {
            const container = document.getElementById('articles');
            container.innerHTML = articles.map(article => `
                <li data-id="${article.id}">
                    <h4>${article.title}</h4>
                    <div class="article-content">${article.content}</div>
                    <div class="article-meta">
                        <span>ä½œè€…ï¼š${article.author}</span>
                        <span>${article.timestamp}</span>
                        <div class="article-controls admin-only">
                            <button onclick="editArticle(${article.id})">âœï¸ç¼–è¾‘</button>
                            <button onclick="deleteArticle(${article.id})">ğŸ—‘ï¸åˆ é™¤</button>
                        </div>
                    </div>
                </li>
            `).join('');
        }

        // ç®¡ç†å‘˜å‘å¸ƒåŠŸèƒ½
        function publishArticle() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if(user?.role !== 'admin') return;
            
            const newArticle = {
                id: Date.now(),
                title: document.getElementById('articleTitle').value,
                content: document.getElementById('articleContent').value,
                author: user.name,
                timestamp: new Date().toLocaleDateString()
            };
            
            articles.push(newArticle);
            localStorage.setItem('articles', JSON.stringify(articles));
            loadArticles();
            toggleEditor();
        }

        // æ–‡ç« ç¼–è¾‘åŠŸèƒ½
        function editArticle(id) {
            const article = articles.find(a => a.id === id);
            document.getElementById('articleTitle').value = article.title;
            document.getElementById('articleContent').value = article.content;
            toggleEditor(true);
        }

        // åˆ é™¤åŠŸèƒ½
        function deleteArticle(id) {
            if(confirm('ç¡®å®šåˆ é™¤è¿™ç¯‡æŒ‡å—ï¼Ÿ')) {
                articles = articles.filter(a => a.id !== id);
                localStorage.setItem('articles', JSON.stringify(articles));
                loadArticles();
            }
        }

        // åˆ‡æ¢ç¼–è¾‘å™¨æ˜¾ç¤º
        function toggleEditor(show = false) {
            const form = document.getElementById('articleForm');
            form.style.display = show ? 'block' : 
                (form.style.display === 'block' ? 'none' : 'block');
        }
    </script>
</body>
</html>
